# T005 - Add Encrypted Record Presence Check (Reuse Existing Vault Verify)

**Type**: BE
**State**: pending
**Phase**: Phase A - Server Correctness

## Business Summary
Allow the client to detect leftover encrypted cloud records while it is in `syncMode='plaintext'`, so we can block plaintext sync (Decision A) and prompt the user to revert or delete.

## Logic
Reuse the existing `POST /api/vault/disable` endpoint with `{ action: 'verify', passphrase }` because it already returns `encryptedRecordCount`. We do **not** add a new endpoint like `/api/sync/has-encrypted`.

## Technical Logic

### API Contract
- Request: `POST /api/vault/disable` with JSON `{ action: 'verify', passphrase: string }`
- Response includes `encryptedRecordCount: number`

### Changes Required
No server code changes required (this task is mostly ensuring we rely on the existing contract).

## Testing
- Backend test should cover that `verify` response includes `encryptedRecordCount` and that it matches the DB count (mocked).

## Files
- **No code changes required** (unless tests reveal missing fields)

## Dependencies
- None

## Notes
Mode-filtering tests belong in **T015** (pull routes), not here.
