# T003: Write Unit Tests for clearAllFilters Action

**Type**: BE-TEST (Unit Test)
**Priority**: High - validates core filter reset behavior
**State**: pending

---

## Business Summary

Ensure clearAllFilters resets all filter states to default values while preserving selectedSpaceId.

---

## Logic

Test that calling `clearAllFilters()` resets:
- searchQuery → ""
- selectedTag → "all"
- sortKey → "newest"
- selectedSpaceId → NOT affected (stays current)

---

## Technical Logic

Create `stores/__tests__/useUiStore.test.ts`:

```typescript
import { describe, it, expect, beforeEach } from 'vitest';
import { useUiStore } from '../useUiStore';

describe('useUiStore - clearAllFilters', () => {
  beforeEach(() => {
    // Reset store to initial state before each test
    useUiStore.setState({
      selectedSpaceId: 'all',
      searchQuery: '',
      selectedTag: 'all',
      sortKey: 'newest',
      isFormOpen: false,
      isImportExportOpen: false,
      isSpacesOpen: false,
    });
  });

  it('should reset all filters to default values', () => {
    // Set non-default filter values
    useUiStore.setState({
      searchQuery: 'test query',
      selectedTag: 'work',
      sortKey: 'oldest',
    });

    // Verify state before clear
    expect(useUiStore.getState().searchQuery).toBe('test query');
    expect(useUiStore.getState().selectedTag).toBe('work');
    expect(useUiStore.getState().sortKey).toBe('oldest');

    // Call clearAllFilters
    useUiStore.getState().clearAllFilters();

    // Verify reset to defaults
    expect(useUiStore.getState().searchQuery).toBe('');
    expect(useUiStore.getState().selectedTag).toBe('all');
    expect(useUiStore.getState().sortKey).toBe('newest');
  });

  it('should preserve selectedSpaceId when clearing filters', () => {
    // Set a specific space
    useUiStore.setState({
      selectedSpaceId: 'space-123',
      searchQuery: 'test',
    });

    // Clear filters
    useUiStore.getState().clearAllFilters();

    // Verify space is preserved
    expect(useUiStore.getState().selectedSpaceId).toBe('space-123');
    expect(useUiStore.getState().searchQuery).toBe('');
  });

  it('should not affect overlay states', () => {
    // Set overlay states
    useUiStore.setState({
      isFormOpen: true,
      isImportExportOpen: true,
      isSpacesOpen: true,
      searchQuery: 'test',
    });

    // Clear filters
    useUiStore.getState().clearAllFilters();

    // Verify filters cleared but overlays unchanged
    expect(useUiStore.getState().searchQuery).toBe('');
    expect(useUiStore.getState().isFormOpen).toBe(true);
    expect(useUiStore.getState().isImportExportOpen).toBe(true);
    expect(useUiStore.getState().isSpacesOpen).toBe(true);
  });
});
```

---

## Testing

Run tests with: `npm test` or project's test command
All tests should pass.

---

## Files

- `stores/__tests__/useUiStore.test.ts` (new)

---

## Patterns

Follow existing test patterns in `components/bookmarks/__tests__/`:
- Use `describe` blocks for grouping
- `beforeEach` to reset state
- Clear test names
- Single assertion per test where possible

---

## Dependencies

- **Blocks**: None
- **Blocked By**: T002

---

## Acceptance Criteria

- [ ] Test file created
- [ ] All 3 test cases pass
- [ ] clearAllFilters resets searchQuery, selectedTag, sortKey
- [ ] clearAllFilters preserves selectedSpaceId
- [ ] clearAllFilters does not affect overlay states
