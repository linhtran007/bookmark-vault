# T008: Refactor page.tsx Callbacks to Use Store Actions

**Type**: FE (Core Refactor)
**Priority**: High - centralizes state mutations
**State**: pending

---

## Business Summary

Centralize state mutations in store actions for consistency.

---

## Logic

Replace inline setState calls with store action calls. Update callback props to use store actions.

---

## Technical Logic

Update `handleApplyPinnedView` (app/page.tsx:49-54):
```typescript
// Before
const handleApplyPinnedView = (view: PinnedView) => {
  setSelectedSpaceId(view.spaceId as SpaceSelection);
  setSearchQuery(view.searchQuery);
  setSelectedTag(view.tag);
  setSortKey(view.sortKey);
};

// After
const handleApplyPinnedView = (view: PinnedView) => {
  useUiStore.getState().applyPinnedView(view);
};
```

Update `handleAddBookmark` (app/page.tsx:47):
```typescript
// Before
const handleAddBookmark = () => setIsFormOpen(true);

// After - can be removed entirely, components will call store directly
// Or keep as:
const handleAddBookmark = () => useUiStore.getState().openForm();
```

Update `useKeyboardShortcuts` call (app/page.tsx:38-45):
```typescript
// Before
useKeyboardShortcuts({
  titleInputRef,
  searchInputRef,
  cardsContainerRef,
  onClearForm: () => setIsFormOpen(false),
  onClearSearch: () => setSearchQuery(""),
  onOpenForm: () => setIsFormOpen(true),
});

// After - these will be updated in T019-T020
useKeyboardShortcuts({
  titleInputRef,
  searchInputRef,
  cardsContainerRef,
});
```

Update button onClick handlers (app/page.tsx:75-82):
```typescript
// Before
<Button onClick={handleAddBookmark}>Add bookmark</Button>
<Button onClick={() => setIsImportExportOpen(true)}>
  <ImportExportIcon />
</Button>

// After
<Button onClick={() => useUiStore.getState().openForm()}>Add bookmark</Button>
<Button onClick={() => useUiStore.getState().openImportExport()}>
  <ImportExportIcon />
</Button>
```

Update mobile spaces button (app/page.tsx:108-114):
```typescript
// Before
<Button onClick={() => setIsSpacesOpen(true)}>Spaces</Button>

// After
<Button onClick={() => useUiStore.getState().openSpaces()}>Spaces</Button>
```

---

## Testing

Manual verification:
- Click handlers work
- No TypeScript errors
- State updates correctly

---

## Files

- `app/page.tsx` (modify - update callbacks)

---

## Patterns

Store action usage pattern.

---

## Dependencies

- **Blocks**: T009, T010, T011, T012, T013
- **Blocked By**: T007

---

## Acceptance Criteria

- [ ] handleApplyPinnedView calls store action
- [ ] Button onClick handlers call store actions
- [ ] No TypeScript errors
- [ ] All callbacks functional
