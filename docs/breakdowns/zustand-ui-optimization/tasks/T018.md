# T018: Refactor BottomSheet Spaces to Use Store State

**Type**: FE (Component Refactor)
**Priority**: Medium - removes overlay props
**State**: pending

---

## Business Summary

Remove isSpacesOpen and onClose props from BottomSheet, read from store.

---

## Logic

Remove isOpen prop from BottomSheet, use store selector, update mobile spaces button to call store action.

---

## Technical Logic

Update BottomSheet usage (app/page.tsx:142-158):

Before:
```typescript
<BottomSheet isOpen={isSpacesOpen} onClose={() => setIsSpacesOpen(false)} className="max-h-[80vh] overflow-auto">
  <SpacesSidebar
    selectedSpaceId={selectedSpaceId}
    onSelectSpaceId={(id) => {
      setSelectedSpaceId(id);
      setIsSpacesOpen(false);
    }}
    searchQuery={searchQuery}
    selectedTag={selectedTag}
    sortKey={sortKey}
    onApplyPinnedView={(view) => {
      handleApplyPinnedView(view);
      setIsSpacesOpen(false);
    }}
    className="w-full"
  />
</BottomSheet>
```

After:
```typescript
<BottomSheet className="max-h-[80vh] overflow-auto">
  <SpacesSidebar className="w-full" />
</BottomSheet>
```

Update SpacesSidebar to auto-close on space selection (T012 should handle this):
```typescript
// In SpacesSidebar, when space is selected:
const setSelectedSpaceId = useUiStore((s) => s.setSelectedSpaceId);
const closeSpaces = useUiStore((s) => s.closeSpaces);

// In space selection handler:
setSelectedSpaceId(id);
closeSpaces(); // Auto-close on selection (mobile UX)
```

Ensure mobile spaces button calls store action (should already be done in T008):
```typescript
<Button onClick={() => useUiStore.getState().openSpaces()}>Spaces</Button>
```

---

## Testing

Manual verification:
- Mobile spaces sheet opens
- Sheet closes on space selection
- Pinned views work in mobile sheet

---

## Files

- `app/page.tsx` (modify)
- `components/spaces/SpacesSidebar.tsx` (potentially - add auto-close logic)

---

## Patterns

Overlay state from store.

---

## Dependencies

- **Blocks**: None
- **Blocked By**: T012

---

## Acceptance Criteria

- [ ] BottomSheet props removed
- [ ] SpacesSheet reads isSpacesOpen from store
- [ ] SpacesSheet auto-closes on selection
- [ ] Mobile spaces functional
