# T012: Refactor SpacesSidebar to Use Store Selectors

**Type**: FE (Component Refactor + Memo)
**Priority**: High - removes prop drilling
**State**: pending

---

## Business Summary

Remove filter props from SpacesSidebar, read from store. Apply React.memo.

---

## Logic

Remove filter props, use store selectors, replace callbacks with store actions.

---

## Technical Logic

Update SpacesSidebar props (components/spaces/SpacesSidebar.tsx:28-36):

Before:
```typescript
interface SpacesSidebarProps {
  selectedSpaceId: SpaceSelection;
  onSelectSpaceId: (spaceId: SpaceSelection) => void;
  searchQuery: string;
  selectedTag: string;
  sortKey: SortKey;
  onApplyPinnedView: (view: PinnedView) => void;
  className?: string;
}
```

After:
```typescript
interface SpacesSidebarProps {
  className?: string;
}
```

Update component:
```typescript
import { useUiStore } from "@/stores/useUiStore";
import { memo } from "react";

function SpacesSidebar({ className }: SpacesSidebarProps) {
  // Read from store
  const selectedSpaceId = useUiStore((s) => s.selectedSpaceId);
  const searchQuery = useUiStore((s) => s.searchQuery);
  const selectedTag = useUiStore((s) => s.selectedTag);
  const sortKey = useUiStore((s) => s.sortKey);
  
  // Store actions
  const setSelectedSpaceId = useUiStore((s) => s.setSelectedSpaceId);
  const applyPinnedView = useUiStore((s) => s.applyPinnedView);

  // Replace onSelectSpaceId(selectedSpaceId) with:
  // setSelectedSpaceId(selectedSpaceId)
  
  // Replace onApplyPinnedView(view) with:
  // applyPinnedView(view)

  // Example updates:
  // Line 179: onSelectSpaceId(created.id) → setSelectedSpaceId(created.id)
  // Line 214: onSelectSpaceId("all") → setSelectedSpaceId("all")
  // Line 278: onClick={() => onSelectSpaceId("all")} → onClick={() => setSelectedSpaceId("all")}
  // Line 301: onClick={() => onSelectSpaceId(space.id)} → onClick={() => setSelectedSpaceId(space.id)}
  // Line 451: onClick={() => onApplyPinnedView(view)} → onClick={() => applyPinnedView(view)}

  // Rest of component unchanged...
}

// Apply memo for conservative optimization
export default memo(SpacesSidebar);
```

---

## Testing

Manual verification:
- Space selection works
- Pinned views apply correctly
- Sidebar functional
- No TypeScript errors

---

## Files

- `components/spaces/SpacesSidebar.tsx` (modify)

---

## Patterns

Conservative memo approach. Selector-based consumption.

---

## Dependencies

- **Blocks**: T013
- **Blocked By**: T008

---

## Acceptance Criteria

- [ ] Filter props removed from SpacesSidebarProps
- [ ] Store selectors used
- [ ] Callbacks replaced with store actions
- [ ] React.memo applied
- [ ] Component functional
- [ ] No TypeScript errors
