# T005: Write Unit Tests for Modal/Sheet Actions

**Type**: BE-TEST (Unit Test)
**Priority**: High - validates overlay state management
**State**: pending

---

## Business Summary

Ensure all overlay state actions (openForm, closeForm, openImportExport, closeImportExport, openSpaces, closeSpaces) work correctly.

---

## Logic

Test each action individually to verify correct boolean state changes and state isolation.

---

## Technical Logic

Add to `stores/__tests__/useUiStore.test.ts`:

```typescript
describe('useUiStore - Modal/Sheet Actions', () => {
  beforeEach(() => {
    // Reset store to initial state before each test
    useUiStore.setState({
      selectedSpaceId: 'all',
      searchQuery: '',
      selectedTag: 'all',
      sortKey: 'newest',
      isFormOpen: false,
      isImportExportOpen: false,
      isSpacesOpen: false,
    });
  });

  describe('Form Modal', () => {
    it('should open form when openForm is called', () => {
      expect(useUiStore.getState().isFormOpen).toBe(false);
      
      useUiStore.getState().openForm();
      
      expect(useUiStore.getState().isFormOpen).toBe(true);
    });

    it('should close form when closeForm is called', () => {
      useUiStore.setState({ isFormOpen: true });
      
      useUiStore.getState().closeForm();
      
      expect(useUiStore.getState().isFormOpen).toBe(false);
    });
  });

  describe('Import/Export Modal', () => {
    it('should open import/export when openImportExport is called', () => {
      expect(useUiStore.getState().isImportExportOpen).toBe(false);
      
      useUiStore.getState().openImportExport();
      
      expect(useUiStore.getState().isImportExportOpen).toBe(true);
    });

    it('should close import/export when closeImportExport is called', () => {
      useUiStore.setState({ isImportExportOpen: true });
      
      useUiStore.getState().closeImportExport();
      
      expect(useUiStore.getState().isImportExportOpen).toBe(false);
    });
  });

  describe('Spaces Sheet', () => {
    it('should open spaces when openSpaces is called', () => {
      expect(useUiStore.getState().isSpacesOpen).toBe(false);
      
      useUiStore.getState().openSpaces();
      
      expect(useUiStore.getState().isSpacesOpen).toBe(true);
    });

    it('should close spaces when closeSpaces is called', () => {
      useUiStore.setState({ isSpacesOpen: true });
      
      useUiStore.getState().closeSpaces();
      
      expect(useUiStore.getState().isSpacesOpen).toBe(false);
    });
  });

  it('should maintain state isolation between overlays', () => {
    // Open all overlays
    useUiStore.getState().openForm();
    useUiStore.getState().openImportExport();
    useUiStore.getState().openSpaces();
    
    expect(useUiStore.getState().isFormOpen).toBe(true);
    expect(useUiStore.getState().isImportExportOpen).toBe(true);
    expect(useUiStore.getState().isSpacesOpen).toBe(true);
    
    // Close one overlay
    useUiStore.getState().closeForm();
    
    // Verify only form is closed, others remain open
    expect(useUiStore.getState().isFormOpen).toBe(false);
    expect(useUiStore.getState().isImportExportOpen).toBe(true);
    expect(useUiStore.getState().isSpacesOpen).toBe(true);
  });
});
```

---

## Testing

Run tests with: `npm test` or project's test command
All tests should pass.

---

## Files

- `stores/__tests__/useUiStore.test.ts` (modify - add new describe block)

---

## Patterns

Parametrized tests for similar open/close actions. Grouped by overlay type.

---

## Dependencies

- **Blocks**: None
- **Blocked By**: T002

---

## Acceptance Criteria

- [ ] Test cases added to useUiStore.test.ts
- [ ] All 7 test cases pass
- [ ] Each open action sets state to true
- [ ] Each close action sets state to false
- [ ] State isolation maintained between overlays
